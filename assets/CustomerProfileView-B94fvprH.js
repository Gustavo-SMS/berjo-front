import{C as U}from"./CustomerRow-Dlb9vk22.js";import{u as C,a as M,r as i,b as S,o as N,c as P,d as y,e as o,w as V,f as b,v as f,g as x,_ as j,h as E,n as L,p as A,i as k}from"./index-Chl9v83D.js";import"./ConfirmationModal-DQxd9VxQ.js";const T={class:"modal-dialog"},q={class:"modal-content"},B={class:"modal-body"},I={class:"mb-3"},z={class:"mb-3"},D={class:"mb-3"},O={__name:"ChangeLoginModel",setup($,{expose:w}){const v=C(),h=M(),n=i(""),e=i(""),t=i(""),c="https://api-berjo.onrender.com",l=S(),p=async()=>{if(n.value!==e.value)return l.addNotification("Os e-mails não coincidem.","error");try{const r=await x(`${c}/users/login`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({newLogin:n.value,currentPassword:t.value})},v,h);if(!r.ok){const s=await r.json();throw new Error(s.error||s.msg||"Erro ao alterar login")}l.addNotification("Login alterado com sucesso!","success"),_(),g()}catch(r){l.addNotification(r.message,"error")}},u=i(null);let a=null;N(()=>{u.value&&(a=new bootstrap.Modal(u.value))});const m=()=>{a&&a.show()},g=()=>{a&&a.hide()},_=()=>{n.value="",e.value="",t.value=""};return w({showModal:m}),(r,s)=>(y(),P("div",{class:"modal fade",ref_key:"loginModal",ref:u,tabindex:"-1"},[o("div",T,[o("div",q,[o("form",{onSubmit:V(p,["prevent"])},[s[6]||(s[6]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Alterar Login"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),o("div",B,[o("div",I,[s[3]||(s[3]=o("label",{class:"form-label"},"Novo login",-1)),b(o("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=d=>n.value=d),required:""},null,512),[[f,n.value]])]),o("div",z,[s[4]||(s[4]=o("label",{class:"form-label"},"Confirmar novo loign",-1)),b(o("input",{type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=d=>e.value=d),required:""},null,512),[[f,e.value]])]),o("div",D,[s[5]||(s[5]=o("label",{class:"form-label"},"Senha atual",-1)),b(o("input",{type:"password",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=d=>t.value=d),required:""},null,512),[[f,t.value]])])]),s[7]||(s[7]=o("div",{class:"modal-footer"},[o("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar"),o("button",{type:"submit",class:"btn btn-primary"},"Salvar alterações")],-1))],32)])])],512))}},R={class:"modal-dialog"},F={class:"modal-content"},J={class:"modal-body"},G={class:"mb-3"},W={class:"mb-3"},H={class:"mb-3"},K={__name:"ChangePasswordModel",setup($,{expose:w}){const v=C(),h=M(),n=S(),e="https://api-berjo.onrender.com",t=i(""),c=i(""),l=i(""),p=async()=>{if(c.value!==l.value)return n.addNotification("As senhas não coincidem.","error");try{const r=await x(`${e}/users/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:t.value,newPassword:c.value,confirmPassword:l.value})},v,h);if(!r.ok){const s=await r.json();throw new Error(s.error||s.msg||"Erro ao alterar senha")}n.addNotification("Senha alterada com sucesso!","success"),_(),g()}catch(r){n.addNotification(r.message,"error")}},u=i(null);let a=null;N(()=>{u.value&&(a=new bootstrap.Modal(u.value))});const m=()=>{a&&a.show()},g=()=>{a&&a.hide()},_=()=>{t.value="",c.value="",l.value=""};return w({showModal:m}),(r,s)=>(y(),P("div",{class:"modal fade",ref_key:"passwordModal",ref:u,tabindex:"-1"},[o("div",R,[o("div",F,[o("form",{onSubmit:V(p,["prevent"])},[s[6]||(s[6]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Alterar Senha"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),o("div",J,[o("div",G,[s[3]||(s[3]=o("label",{class:"form-label"},"Senha Atual",-1)),b(o("input",{type:"password",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=d=>t.value=d),required:""},null,512),[[f,t.value]])]),o("div",W,[s[4]||(s[4]=o("label",{class:"form-label"},"Nova Senha",-1)),b(o("input",{type:"password",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=d=>c.value=d),required:""},null,512),[[f,c.value]])]),o("div",H,[s[5]||(s[5]=o("label",{class:"form-label"},"Confirmar Nova Senha",-1)),b(o("input",{type:"password",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=d=>l.value=d),required:""},null,512),[[f,l.value]])])]),s[7]||(s[7]=o("div",{class:"modal-footer"},[o("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar"),o("button",{type:"submit",class:"btn btn-primary"},"Alterar")],-1))],32)])])],512))}},Q={class:"container"},X={class:"box"},Y={class:"d-flex flex-column flex-md-row gap-2 mt-4"},Z={__name:"CustomerProfileView",setup($){const w="https://api-berjo.onrender.com",v=C(),h=M(),n=S(),e=i(null),t=async()=>{try{const a=await x(`${w}/customers/${v.customerId}`,{method:"GET",headers:{"Content-Type":"application/json"}},v,h);if(!a.ok){const g=await a.json();throw new Error(g.error||"Erro ao buscar dados do cliente")}const m=await a.json();e.value=m}catch(a){console.log(a.message),n.addNotification(a.message,"error")}},c=i(null),l=()=>{var a;(a=c.value)==null||a.showModal()},p=i(null),u=()=>{var a;(a=p.value)==null||a.showModal()};return N(t),(a,m)=>(y(),P("div",Q,[o("div",X,[m[0]||(m[0]=E('<div class="row fw-bold mb-3 text-center" data-v-fc2b9951><div class="col-2" data-v-fc2b9951>Nome</div><div class="col-2" data-v-fc2b9951>Email</div><div class="col-1" data-v-fc2b9951>Telefone</div><div class="col-2" data-v-fc2b9951>Rua</div><div class="col-1" data-v-fc2b9951>Número</div><div class="col-2" data-v-fc2b9951>Cidade</div><div class="col-1" data-v-fc2b9951>Bairro</div><div class="col-1" data-v-fc2b9951>CEP</div><div class="col-1" data-v-fc2b9951>Dívida</div></div>',1)),e.value?(y(),L(U,{key:0,id:e.value.id,name:e.value.name,email:e.value.email,phone:e.value.phone,street:e.value.address.street,house_number:e.value.address.house_number,city:e.value.address.city,district:e.value.address.district,zip:e.value.address.zip,debt:e.value.debt,getCustomers:t},null,8,["id","name","email","phone","street","house_number","city","district","zip","debt"])):A("",!0),o("div",Y,[o("button",{class:"btn btn-outline-warning w-100",onClick:u},"Alterar senha"),k(K,{ref_key:"changePasswordModal",ref:p},null,512),o("button",{class:"btn btn-outline-warning w-100",onClick:l},"Alterar login"),k(O,{ref_key:"changeLoginModal",ref:c},null,512)])])]))}},eo=j(Z,[["__scopeId","data-v-fc2b9951"]]);export{eo as default};
