import{a as M,u as U,b as V,r as u,c as s,d as e,e as o,n as D,p as j,f,v as b,t as g,q as $,F as _,w as R,T as I,g as C,_ as z,o as L,l as P}from"./index-DmVvP4hk.js";import{C as q}from"./ConfirmationModal-CegNd6Pf.js";const F={key:1,class:"mb-0"},G={key:1,class:"mb-0"},W={key:1,class:"mb-0"},J={key:1,class:"mb-0"},O={key:1,class:"mb-0"},H={key:0,class:"actions"},K={__name:"BlindTypeRow",props:["id","type","collection","color","max_width","price","getBlindTypes"],setup(m){const h=M(),y=U(),v=V(),w="https://api-berjo.onrender.com",l=m,d=u(!1),k=()=>{d.value=!0},c=u(!1);let i=u(!0);const t=()=>{c.value=!c.value,i.value=!i.value},a=u(l.type),x=u(l.collection),T=u(l.color),E=u(l.max_width),B=u(l.price),N=async p=>{p.preventDefault();const n={id:l.id,type:a.value,collection:x.value,color:T.value,max_width:E.value,price:B.value};try{const r=await C(`${w}/blind_types`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},y,h);if(!r.ok){const A=await r.json();throw new Error(A.error||"Erro ao atualizar tipo")}v.addNotification("Tipo atualizado com sucesso!","success"),l.getBlindTypes(),t()}catch(r){console.error("Erro ao enviar os dados:",r.message),v.addNotification(r.message,"error")}},S=async()=>{try{const p=await C(`${w}/blind_types/${l.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"}},y,h);if(!p.ok){const n=await p.json();throw new Error(n.error||"Erro ao excluir tipo")}v.addNotification("Tipo excluído com sucesso","success"),l.getBlindTypes()}catch(p){console.error("Erro ao excluir cliente:",p.message),v.addNotification(p.message,"error")}};return(p,n)=>(e(),s(_,null,[o("form",{onSubmit:R(N,["prevent"]),class:"blind-type-form"},[o("div",null,[c.value?f((e(),s("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":n[0]||(n[0]=r=>a.value=r),id:"type",name:"type"},null,512)),[[b,a.value]]):(e(),s("p",F,g(m.type),1))]),o("div",null,[c.value?f((e(),s("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":n[1]||(n[1]=r=>x.value=r),id:"collection",name:"collection"},null,512)),[[b,x.value]]):(e(),s("p",G,g(m.collection),1))]),o("div",null,[c.value?f((e(),s("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":n[2]||(n[2]=r=>T.value=r),id:"color",name:"color"},null,512)),[[b,T.value]]):(e(),s("p",W,g(m.color),1))]),o("div",null,[c.value?f((e(),s("input",{key:0,type:"number",class:"form-control","onUpdate:modelValue":n[3]||(n[3]=r=>E.value=r),id:"max_width",name:"max_width",min:"0"},null,512)),[[b,E.value]]):(e(),s("p",J,g(m.max_width),1))]),o("div",null,[c.value?f((e(),s("input",{key:0,type:"number",class:"form-control","onUpdate:modelValue":n[4]||(n[4]=r=>B.value=r),id:"price",name:"price",min:"0",step:"0.01"},null,512)),[[b,B.value]]):(e(),s("p",O,"R$ "+g(m.price),1))]),$(y).userRole==="ADMIN"?(e(),s("div",H,[c.value?(e(),s(_,{key:0},[o("button",{type:"submit",onClick:N,class:"btn btn-success"},"Confirmar"),o("button",{type:"button",onClick:t,class:"btn btn-secondary"},"Cancelar")],64)):(e(),s(_,{key:1},[o("button",{onClick:t,type:"button",class:"btn btn-primary"},"Editar"),$(y).userRole==="ADMIN"?(e(),s("button",{key:0,onClick:k,type:"button",class:"btn btn-danger"},"Excluir")):j("",!0)],64))])):j("",!0)],32),(e(),D(I,{to:"body"},[d.value?(e(),D(q,{key:0,show:d.value,message:"Tem certeza que deseja excluir este tipo?",onConfirm:S,onClose:n[5]||(n[5]=r=>d.value=!1)},null,8,["show"])):j("",!0)]))],64))}},Q={class:"container"},X={class:"search-section"},Y={__name:"BlindTypeView",setup(m){const h="https://api-berjo.onrender.com",y=U(),v=M(),w=V(),l=u([]),d=u(""),k=async()=>{try{const i=await C(`${h}/blind_types`,{method:"GET",headers:{"Content-type":"application/json"},credentials:"include"},y,v);if(!i.ok){const a=await i.json();throw new Error(a.error||"Erro ao buscar clientes")}const t=await i.json();l.value=t}catch(i){console.log(i.message),w.addNotification(i.message,"error")}};L(k);const c=async i=>{if(i.preventDefault(),!d.value)return k();try{const t=await C(`${h}/blind_types/type/${d.value}`,{method:"GET",headers:{"Content-type":"application/json"}},y,v);if(!t.ok){const x=await t.json();throw new Error(x.error||"Erro ao buscar tipo")}const a=await t.json();l.value=a}catch(t){console.log(t.message),w.addNotification(t.message,"error")}};return(i,t)=>(e(),s("div",Q,[o("div",X,[f(o("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),type:"text",id:"searchByType",class:"form-input",placeholder:"Buscar por tipo"},null,512),[[b,d.value]]),o("button",{onClick:c,class:"btn-secondary"},"Buscar")]),t[1]||(t[1]=o("div",{class:"header-row"},[o("span",null,"Tipo"),o("span",null,"Coleção"),o("span",null,"Cor"),o("span",null,"Largura Máx."),o("span",null,"Preço"),o("span",null,"Ações")],-1)),(e(!0),s(_,null,P(l.value,a=>(e(),D(K,{key:a.id,id:a.id,type:a.type,collection:a.collection,color:a.color,max_width:a.max_width,price:a.price,getBlindTypes:k},null,8,["id","type","collection","color","max_width","price"]))),128))]))}},oe=z(Y,[["__scopeId","data-v-3340fcb1"]]);export{oe as default};
