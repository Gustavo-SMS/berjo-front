import{u as w,a as y,b,r as p,o as C,j as _,f as j,k as D,c as d,d as l,e as u,F as E,l as N,t as O,g as S,_ as U,i as V,h as $,w as q}from"./index-DfWB3UVD.js";const x=["value"],F={__name:"SelectUnlinkedCustomers",props:["refreshKey"],emits:["selectedOption"],setup(h){const m=h,n=w(),f=y(),v=b(),i="https://api-berjo.onrender.com",r=p(""),c=p([]),s=async()=>{try{const t=await S(`${i}/customers/unlinked`,{method:"GET",headers:{"Content-type":"application/json"},credentials:"include"},n,f),e=await t.json();if(!t.ok)throw new Error(e.error||"Erro ao buscar clientes");c.value=e}catch(t){console.error(t.message),v.addNotification(t.message,"error")}};return C(s),_(()=>m.refreshKey,()=>{s()}),(t,e)=>j((l(),d("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),onChange:e[1]||(e[1]=o=>t.$emit("selectedOption",r.value)),class:"form-select"},[e[2]||(e[2]=u("option",{disabled:"",value:""},"Selecione um cliente",-1)),(l(!0),d(E,null,N(c.value,o=>(l(),d("option",{key:o.id,value:o.id},O(o.name),9,x))),128))],544)),[[D,r.value]])}},I={class:"register-container"},P={__name:"RegisterView",setup(h){const m="https://api-berjo.onrender.com",n=b(),f=y(),v=w(),i=p(""),r=p(0),c=t=>{i.value=t},s=async t=>{t.preventDefault();const e=document.querySelector("form"),o=new FormData(e),g=Object.fromEntries(o);g.customerId=i.value;try{const a=await S(`${m}/register`,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(g)},v,f);if(!a.ok){const k=await a.json();throw new Error(k.error||"Erro ao cadastrar usuário")}n.addNotification("Cliente cadastrado com sucesso!","success"),r.value++,e.reset()}catch(a){console.log(a.message),n.addNotification(a.message,"error")}};return(t,e)=>(l(),d("main",I,[u("form",{class:"register-form",onSubmit:q(s,["prevent"])},[e[0]||(e[0]=u("h1",{class:"register-title"},"Cadastre o usuário",-1)),V(F,{onSelectedOption:c,"refresh-key":r.value},null,8,["refresh-key"]),e[1]||(e[1]=$('<div class="form-group" data-v-84ad206c><label for="login" data-v-84ad206c>Login</label><input id="login" name="login" type="text" class="form-input" placeholder="Digite o login" required data-v-84ad206c></div><div class="form-group" data-v-84ad206c><label for="password" data-v-84ad206c>Senha</label><input id="password" name="password" type="password" class="form-input" placeholder="Digite a senha" required data-v-84ad206c></div><div class="form-group" data-v-84ad206c><label for="confirmPassword" data-v-84ad206c>Confirmar Senha</label><input id="confirmPassword" name="confirmPassword" type="password" class="form-input" placeholder="Confirme a senha" required data-v-84ad206c></div>',3)),u("button",{class:"btn-primary full-width",type:"submit",onClick:s},"Entrar")],32)]))}},K=U(P,[["__scopeId","data-v-84ad206c"]]);export{K as default};
