import{C as V}from"./CustomerRow-Bx6XqKkU.js";import{u as C,a as M,r as d,b as S,o as N,c as P,d as y,e as o,w as U,f,v as b,g as x,_ as j,n as E,p as L,i as k}from"./index-Dc1vcSU_.js";import"./ConfirmationModal-DPzCp7fV.js";const A={class:"modal-dialog"},T={class:"modal-content"},q={class:"modal-body"},B={class:"mb-3"},I={class:"mb-3"},z={class:"mb-3"},D={__name:"ChangeLoginModel",setup($,{expose:w}){const v=C(),h=M(),n=d(""),a=d(""),t=d(""),u="https://api-berjo.onrender.com",l=S(),p=async()=>{if(n.value!==a.value)return l.addNotification("Os e-mails não coincidem.","error");try{const r=await x(`${u}/users/login`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({newLogin:n.value,currentPassword:t.value})},v,h);if(!r.ok){const e=await r.json();throw new Error(e.error||e.msg||"Erro ao alterar login")}l.addNotification("Login alterado com sucesso!","success"),_(),g()}catch(r){l.addNotification(r.message,"error")}},c=d(null);let s=null;N(()=>{c.value&&(s=new bootstrap.Modal(c.value))});const m=()=>{s&&s.show()},g=()=>{s&&s.hide()},_=()=>{n.value="",a.value="",t.value=""};return w({showModal:m}),(r,e)=>(y(),P("div",{class:"modal fade",ref_key:"loginModal",ref:c,tabindex:"-1"},[o("div",A,[o("div",T,[o("form",{onSubmit:U(p,["prevent"])},[e[6]||(e[6]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Alterar Login"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),o("div",q,[o("div",B,[e[3]||(e[3]=o("label",{class:"form-label"},"Novo login",-1)),f(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=i=>n.value=i),required:""},null,512),[[b,n.value]])]),o("div",I,[e[4]||(e[4]=o("label",{class:"form-label"},"Confirmar novo loign",-1)),f(o("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=i=>a.value=i),required:""},null,512),[[b,a.value]])]),o("div",z,[e[5]||(e[5]=o("label",{class:"form-label"},"Senha atual",-1)),f(o("input",{type:"password",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=i=>t.value=i),required:""},null,512),[[b,t.value]])])]),e[7]||(e[7]=o("div",{class:"modal-footer"},[o("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar"),o("button",{type:"submit",class:"btn btn-primary"},"Salvar alterações")],-1))],32)])])],512))}},O={class:"modal-dialog"},R={class:"modal-content"},F={class:"modal-body"},J={class:"mb-3"},G={class:"mb-3"},W={class:"mb-3"},H={__name:"ChangePasswordModel",setup($,{expose:w}){const v=C(),h=M(),n=S(),a="https://api-berjo.onrender.com",t=d(""),u=d(""),l=d(""),p=async()=>{if(u.value!==l.value)return n.addNotification("As senhas não coincidem.","error");try{const r=await x(`${a}/users/password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:t.value,newPassword:u.value,confirmPassword:l.value})},v,h);if(!r.ok){const e=await r.json();throw new Error(e.error||e.msg||"Erro ao alterar senha")}n.addNotification("Senha alterada com sucesso!","success"),_(),g()}catch(r){n.addNotification(r.message,"error")}},c=d(null);let s=null;N(()=>{c.value&&(s=new bootstrap.Modal(c.value))});const m=()=>{s&&s.show()},g=()=>{s&&s.hide()},_=()=>{t.value="",u.value="",l.value=""};return w({showModal:m}),(r,e)=>(y(),P("div",{class:"modal fade",ref_key:"passwordModal",ref:c,tabindex:"-1"},[o("div",O,[o("div",R,[o("form",{onSubmit:U(p,["prevent"])},[e[6]||(e[6]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Alterar Senha"),o("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),o("div",F,[o("div",J,[e[3]||(e[3]=o("label",{class:"form-label"},"Senha Atual",-1)),f(o("input",{type:"password",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=i=>t.value=i),required:""},null,512),[[b,t.value]])]),o("div",G,[e[4]||(e[4]=o("label",{class:"form-label"},"Nova Senha",-1)),f(o("input",{type:"password",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=i=>u.value=i),required:""},null,512),[[b,u.value]])]),o("div",W,[e[5]||(e[5]=o("label",{class:"form-label"},"Confirmar Nova Senha",-1)),f(o("input",{type:"password",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=i=>l.value=i),required:""},null,512),[[b,l.value]])])]),e[7]||(e[7]=o("div",{class:"modal-footer"},[o("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancelar"),o("button",{type:"submit",class:"btn btn-primary"},"Alterar")],-1))],32)])])],512))}},K={class:"container"},Q={class:"box"},X={class:"d-flex flex-column flex-md-row gap-2 mt-4"},Y={__name:"CustomerProfileView",setup($){const w="https://api-berjo.onrender.com",v=C(),h=M(),n=S(),a=d(null),t=async()=>{try{const s=await x(`${w}/customers/${v.customerId}`,{method:"GET",headers:{"Content-Type":"application/json"}},v,h);if(!s.ok){const g=await s.json();throw new Error(g.error||"Erro ao buscar dados do cliente")}const m=await s.json();a.value=m}catch(s){console.log(s.message),n.addNotification(s.message,"error")}},u=d(null),l=()=>{var s;(s=u.value)==null||s.showModal()},p=d(null),c=()=>{var s;(s=p.value)==null||s.showModal()};return N(t),(s,m)=>(y(),P("div",K,[o("div",Q,[m[0]||(m[0]=o("div",{class:"customer-header"},[o("div",null,"Nome"),o("div",null,"Email"),o("div",null,"Telefone"),o("div",null,"Rua"),o("div",null,"Nº"),o("div",null,"Cidade"),o("div",null,"Bairro"),o("div",null,"CEP"),o("div",null,"Dívida")],-1)),a.value?(y(),E(V,{key:0,id:a.value.id,name:a.value.name,email:a.value.email,phone:a.value.phone,street:a.value.address.street,house_number:a.value.address.house_number,city:a.value.address.city,district:a.value.address.district,zip:a.value.address.zip,debt:a.value.debt,getCustomers:t},null,8,["id","name","email","phone","street","house_number","city","district","zip","debt"])):L("",!0),o("div",X,[o("button",{class:"btn btn-outline-warning w-100",onClick:c},"Alterar senha"),k(H,{ref_key:"changePasswordModal",ref:p},null,512),o("button",{class:"btn btn-outline-warning w-100",onClick:l},"Alterar login"),k(D,{ref_key:"changeLoginModal",ref:u},null,512)])])]))}},so=j(Y,[["__scopeId","data-v-0ef9e7a4"]]);export{so as default};
