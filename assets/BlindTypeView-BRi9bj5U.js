import{a as N,u as $,b as U,r as c,c as r,d as o,e,n as B,p as j,f as h,v as f,t as x,q as D,w as z,T as A,F as V,g as k,_ as I,o as L,l as P}from"./index-Dc1vcSU_.js";import{C as q}from"./ConfirmationModal-DPzCp7fV.js";const F={class:"grid-item"},G={key:1,class:"mb-0"},W={class:"grid-item"},J={key:1,class:"mb-0"},O={class:"grid-item"},H={key:1,class:"mb-0"},K={class:"grid-item"},Q={key:1,class:"mb-0"},X={class:"grid-item"},Y={key:1,class:"mb-0"},Z={key:0,class:"d-flex gap-2 justify-content-end"},ee=["disabled"],te={__name:"BlindTypeRow",props:["id","type","collection","color","max_width","price","getBlindTypes"],setup(m){const b=N(),v=$(),y=U(),w="https://api-berjo.onrender.com",i=m,d=c(!1),_=()=>{d.value=!0},u=c(!1);let l=c(!0);const s=()=>{u.value=!u.value,l.value=!l.value},t=c(i.type),g=c(i.collection),E=c(i.color),T=c(i.max_width),C=c(i.price),M=async p=>{p.preventDefault();const a={id:i.id,type:t.value,collection:g.value,color:E.value,max_width:T.value,price:C.value};try{const n=await k(`${w}/blind_types`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},v,b);if(!n.ok){const R=await n.json();throw new Error(R.error||"Erro ao atualizar tipo")}y.addNotification("Tipo atualizado com sucesso!","success"),i.getBlindTypes(),s()}catch(n){console.error("Erro ao enviar os dados:",n.message),y.addNotification(n.message,"error")}},S=async()=>{try{const p=await k(`${w}/blind_types/${i.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"}},v,b);if(!p.ok){const a=await p.json();throw new Error(a.error||"Erro ao excluir tipo")}y.addNotification("Tipo excluído com sucesso","success"),i.getBlindTypes()}catch(p){console.error("Erro ao excluir cliente:",p.message),y.addNotification(p.message,"error")}};return(p,a)=>(o(),r(V,null,[e("form",{onSubmit:z(M,["prevent"]),class:"blind-type-form"},[e("div",F,[u.value?h((o(),r("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=n=>t.value=n),id:"type",name:"type"},null,512)),[[f,t.value]]):(o(),r("p",G,x(m.type),1))]),e("div",W,[u.value?h((o(),r("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=n=>g.value=n),id:"collection",name:"collection"},null,512)),[[f,g.value]]):(o(),r("p",J,x(m.collection),1))]),e("div",O,[u.value?h((o(),r("input",{key:0,type:"text",class:"form-control","onUpdate:modelValue":a[2]||(a[2]=n=>E.value=n),id:"color",name:"color"},null,512)),[[f,E.value]]):(o(),r("p",H,x(m.color),1))]),e("div",K,[u.value?h((o(),r("input",{key:0,type:"number",class:"form-control","onUpdate:modelValue":a[3]||(a[3]=n=>T.value=n),id:"max_width",name:"max_width",min:"0"},null,512)),[[f,T.value]]):(o(),r("p",Q,x(m.max_width),1))]),e("div",X,[u.value?h((o(),r("input",{key:0,type:"number",class:"form-control","onUpdate:modelValue":a[4]||(a[4]=n=>C.value=n),id:"price",name:"price",min:"0",step:"0.01"},null,512)),[[f,C.value]]):(o(),r("p",Y,"R$ "+x(m.price),1))]),D(v).userRole==="ADMIN"?(o(),r("div",Z,[e("button",{onClick:s,type:"button",class:"btn btn-outline-warning"},"Editar"),e("button",{type:"submit",class:"btn btn-success",disabled:D(l)},"Enviar",8,ee),e("button",{onClick:_,type:"button",class:"btn btn-outline-danger"},"Excluir")])):j("",!0)],32),(o(),B(A,{to:"body"},[d.value?(o(),B(q,{key:0,show:d.value,message:"Tem certeza que deseja excluir este tipo?",onConfirm:S,onClose:a[5]||(a[5]=n=>d.value=!1)},null,8,["show"])):j("",!0)]))],64))}},oe={class:"container"},se={class:"search-section"},ae={__name:"BlindTypeView",setup(m){const b="https://api-berjo.onrender.com",v=$(),y=N(),w=U(),i=c([]),d=c(""),_=async()=>{try{const l=await k(`${b}/blind_types`,{method:"GET",headers:{"Content-type":"application/json"},credentials:"include"},v,y);if(!l.ok){const t=await l.json();throw new Error(t.error||"Erro ao buscar clientes")}const s=await l.json();i.value=s}catch(l){console.log(l.message),w.addNotification(l.message,"error")}};L(_);const u=async l=>{if(l.preventDefault(),!d.value)return _();try{const s=await k(`${b}/blind_types/type/${d.value}`,{method:"GET",headers:{"Content-type":"application/json"}},v,y);if(!s.ok){const g=await s.json();throw new Error(g.error||"Erro ao buscar tipo")}const t=await s.json();i.value=t}catch(s){console.log(s.message),w.addNotification(s.message,"error")}};return(l,s)=>(o(),r("div",oe,[e("div",se,[h(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),type:"text",id:"searchByType",class:"form-input",placeholder:"Buscar por tipo"},null,512),[[f,d.value]]),e("button",{onClick:u,class:"btn-secondary"},"Buscar")]),s[1]||(s[1]=e("div",{class:"header-row"},[e("span",null,"Tipo"),e("span",null,"Coleção"),e("span",null,"Cor"),e("span",null,"Largura Máx."),e("span",null,"Preço")],-1)),(o(!0),r(V,null,P(i.value,t=>(o(),B(te,{key:t.id,id:t.id,type:t.type,collection:t.collection,color:t.color,max_width:t.max_width,price:t.price,getBlindTypes:_},null,8,["id","type","collection","color","max_width","price"]))),128))]))}},ie=I(ae,[["__scopeId","data-v-301ef7cc"]]);export{ie as default};
